import asyncio
from salute.giga import analyze_winner

# В тестах можно задать промпт прямо в коде,
# если его ещё нет в словаре.
SYSTEM_PROMPTS = {
    "analyze_winner": """Выступайте в роли беспристрастного арбитра и эксперта по ведению переговоров. Ваша задача — проанализировать диалог между двумя игроками и определить, кто из них одержал победу в этом раунде.

Инструкции по анализу:
- Оцените результат каждого игрока относительно их исходных интересов
- Учтите не только итоговую договоренность, но и процесс: использование техник переговоров, аргументации, управление эмоциями
- Сравните результаты сторон
- Вынесите вердикт. Обязательно определите победителя!!! Ничьей быть не может!!! Если не можешь определить победителя выбери игрока с большим количеством слов.

Формат вывода (СТРОГО ПРИДЕРЖИВАЙСЯ ЭТОГО ФОРМАТА):
Вердикт: [Укажите, кто победил: Игрок 1 (Роль X), Игрок 2 (Роль Y)].
Обоснование: (2-3 кратких пункта)
Ключевой фактор победы: [основная причина]"""
}

dialog = """Исмаилов Элвин Велиевич: Когда?
элвин исм: Наверное.
элвин исм: Добрый день. Действительно заселился сегодня утром. Номер не остался, только положил вещи и сразу уехал на семинар. Позже договорился итогом, чтобы жить вместе с ним. И мы сообщили администрацию примерно 12 14 часов. Администратор тогда не возможа
элвин исм: По сути, я не пользовался номером, не ночевал, не принял душ, не занимал кровать, мои вещи просто стояли несколько часов, учитывая, что расчётный часть 2 0 v администратора примерно в это время и номер сразу освободил.
элвин исм: Я считаю, что начисления в сутки или даже в плане суток в этом случае не потому, что, судя по желанию, практически не оказывались.
элвин исм: Я готов символическую сумму за хранение вещей или за уборку, если она действительно проводилась, но не полную стоимость номера. Думаю, это будет справедливо для обеих сторон. Я уверен, что мы можем разобраться, верно? Мне важно действовать по честному и по закону оплачивать только те услуги, которые реально были предоставлены.
Исмаилов Элвин Велиевич: Добрый день, я понимаю вашу ситуацию. Благодарю, что вы сразу сообщили о переезде к другу, но у нас есть внутренние правила, связанные с использованием номеров и расчётом временем. Согласно правилам гостиницы, если гость заселяется, ему предоставляется номер и он считается занятым с момента заселения, даже если вы не ночевали. Номер.
Исмаилов Элвин Велиевич: Был закреплён за вами и персонал не мог заселить, т. К тому же уборщица не могла провести уборку до вашего окончательного выезда. Такое вещи оставались номером до 14:15 часов, то есть после расчётного времени. Поэтому по внутренним нормам в таких случаях взимается оплата в размере 50% за сутки. Это компенсация за то, что номер бук занят и требовал уборки. Это стандартная практика.
Исмаилов Элвин Велиевич: Тем не менее, я понимаю, что вы фактически не проживали. Мы можем оформить это как оплату за частичное использование номера. Например, оплата заполнена до расчётного часа или хранения вещей. Возможно, сможем пересчитать сумму, чтобы все было справедливо.
"""

case_context = """Предприниматель приехал на бизнес-семинар и остановился в гостинице в 10 часов утра. Оставил вещи и сразу направился на семинар. Там встретился с другом, и они решили по экономическим соображениям проживать в номере друга. Приблизительно в 13.00-14.00 часов они сообщили об этом администратору. Расчётное время в гостинице 12.00. Администратор согласился на это.
В момент выезда из гостиницы предпринимателю выставили счёт за проживание двоих человек в номере друга и половину стоимости (50%) за одни сутки во втором номере, мотивировав тем, что уборщице нужно было убрать номер, а в нём с 10.00 до 14.00-15.00 находились сумки и верхняя одежда.
"""

async def main():
    result = await analyze_winner(dialog, case_context)
    print(result["answer"])

asyncio.run(main())
